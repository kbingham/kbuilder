## Build a gst-plugins-good package

GST_PLUGINS_GOOD_SRC?=$(BUILDSYS_SOURCES)/gst-plugins-good
GST_PLUGINS_GOOD_BUILD=$(BUILDSYS_BUILD)/$(ARCH)/gst-plugins-good
GST_PLUGINS_GOOD_INSTALL=$(BUILDSYS_INSTALL)/$(ARCH)/gst-plugins-good

GST_PLUGINS_GOOD_GIT=git://anongit.freedesktop.org/git/gstreamer/gst-plugins-good
GST_PLUGINS_GOOD_BRANCH?=master


APT_PACKAGE_DEPENDENCIES += autopoint

$(GST_PLUGINS_GOOD_BUILD) $(GST_PLUGINS_GOOD_INSTALL):
	@mkdir -p $@

$(GST_PLUGINS_GOOD_SRC):
	git clone $(GST_PLUGINS_GOOD_GIT) -b $(GST_PLUGINS_GOOD_BRANCH) $@

gst-plugins-good: gst-plugins-good-build gst-plugins-good-install-target

$(GST_PLUGINS_GOOD_SRC)/configure: | $(GST_PLUGINS_GOOD_SRC)
	$(AT_ENVIRONMENT) \
	cd $(GST_PLUGINS_GOOD_BUILD) && \
	$(GST_PLUGINS_GOOD_SRC)/autogen.sh \
		--disable-gtk-doc \
		--prefix=/usr \
		--enable-v4l2-probe \
		--host=$(AT_TARGET_HOST) \

gst-plugins-good-configure $(GST_PLUGINS_GOOD_BUILD)/Makefile: | $(GST_PLUGINS_GOOD_SRC) $(GST_PLUGINS_GOOD_BUILD) $(GST_PLUGINS_GOOD_SRC)/configure
	$(AT_ENVIRONMENT) \
	cd $(GST_PLUGINS_GOOD_BUILD) && \
	$(GST_PLUGINS_GOOD_SRC)/configure \
		--enable-v4l2-probe \
		--prefix=/usr \
		--host=$(AT_TARGET_HOST) \

gst-plugins-good-configure-help: | $(GST_PLUGINS_GOOD_SRC) $(GST_PLUGINS_GOOD_BUILD) $(GST_PLUGINS_GOOD_SRC)/configure
	$(AT_ENVIRONMENT) \
	cd $(GST_PLUGINS_GOOD_BUILD) && \
	$(GST_PLUGINS_GOOD_SRC)/configure \
		--help


gst-plugins-good-build: $(GST_PLUGINS_GOOD_BUILD)/Makefile
	$(AT_ENVIRONMENT) \
	$(MAKE) -j 8 -C $(GST_PLUGINS_GOOD_BUILD)

gst-plugins-good-install: $(GST_PLUGINS_GOOD_INSTALL)
	$(AT_ENVIRONMENT) \
	$(MAKE) -j 8 -C $(GST_PLUGINS_GOOD_BUILD) install DESTDIR=$(GST_PLUGINS_GOOD_INSTALL)

gst-plugins-good-install-host: GST_PLUGINS_GOOD_INSTALL=$(BUILDSYS_HOST)
gst-plugins-good-install-host: gst-plugins-good-install

gst-plugins-good-install-target: GST_PLUGINS_GOOD_INSTALL=$(ROOTFS)
gst-plugins-good-install-target: gst-plugins-good-install

gst-plugins-good-distclean:
	rm -rf $(GST_PLUGINS_GOOD_BUILD)

gst-plugins-good-help:
	@
